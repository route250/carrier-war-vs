海戦シミュレーションゲーム ルール詳細

基本ルール
	•	プレイヤーはそれぞれ空母を1隻操作する。
	•	航空部隊を発艦させ、敵空母を撃沈すれば勝利。
	•	ゲームはターン制・同時進行。両者が指示を完了したら処理が実行される。

⸻

勝敗条件
	1.	敵空母を撃沈したら勝ち。
	2.	20ターン終了時、空母HPが多い方が勝ち。
	3.	空母HPが同じ場合は引き分け。
	4.	両者とも航空部隊を失った場合は引き分け。
	5.	片方のみ航空部隊が全滅した場合、その時点で決着。

⸻

マップ
	•	サイズ: 30×30ヘクスマップ
	•	地形: 海とランダム生成の陸地
	•	制約:
	•	空母は陸地に入れない
	•	航空部隊は陸地も移動可能
	•	陸地は索敵や攻撃を妨害しない

⸻

空母
	•	移動速度: 2ヘクス/ターン
	•	索敵範囲: 半径4ヘクス（移動経路を中心に判定）
	•	HPを持ち、0で撃沈
	•	初期配置: マップ左上付近と右下付近にランダム配置

⸻

航空部隊
	•	各空母に 2部隊配備
	•	移動速度: 4ヘクス/ターン
	•	索敵範囲: 半径4ヘクス（移動経路を中心に判定）
	•	HPを持ち、0で消滅（Lost）
	•	発艦後は帰投まで指示不可
	•	帰投先は常に空母（空母が移動していればその新しい位置）

⸻

発艦ルール
	•	1ターンで発艦できるのは1部隊のみ
	•	発艦済みの部隊が帰投していなくても、別のターンにもう1部隊を発艦可能
	•	帰投済みの部隊は即再発艦可能（クールダウンなし）

⸻

索敵
	•	索敵範囲内に入った敵は「発見」状態になる
	•	発見状態は 3ターン間ゴースト表示される
	•	ゴーストは「発見時の位置」のみを示し、現在位置とは限らない

⸻

戦闘
	•	航空部隊は指定地点に移動
	•	索敵範囲に敵空母があれば攻撃、いなければ帰投

ダメージ計算

ダメージは「最大HPに対する現在HPの割合」でスケーリングし、さらに±20%の乱数ブレを加えた値を採用する。
	•	共通関数（疑似コード）:

def scaled_damage(hp, max_hp, base):
    hp = hp if hp is not None else max_hp
    scale = max(0.0, min(1.0, hp / float(max_hp)))
    variance = round(base * 0.2)
    raw = base + (0 if variance == 0 else random.randint(-variance, variance))
    return max(0, round(raw * scale))


	•	攻撃側（航空部隊 → 空母）
base = 25
	•	迎撃側（空母の対空砲火 AA → 航空部隊）
base = 20

処理の流れ
	1.	航空部隊が攻撃条件を満たすと、敵空母へダメージ（base=25）を適用
	2.	同ターン内に、敵空母の AA（base=20）を航空部隊へ適用
	3.	いずれかの HP が 0 以下になった場合:
	•	空母 HP ≤ 0 → 撃沈（その場で敗北条件を満たす可能性）
	•	航空部隊 HP ≤ 0 → 撃墜（ユニット Lost）
	4.	撃墜されなかった航空部隊は攻撃を終え、帰投状態へ移行

ログイベント
	•	attack: 攻撃イベント（ターン・位置・与ダメージ・被AA）
	•	sunk: 空母撃沈イベント
	•	shot_down: 航空部隊撃墜イベント
	•	例: [Turn 7] SqdA attacks CV_B: dmg=18, AA=7

⸻
